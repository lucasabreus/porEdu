<!DOCTYPE html>
<html lang="pt-br">
	<head> 
		<meta charset="UTF-8" /> 
		<title>PorEDU</title> 
		<link rel="stylesheet" href="css/reset.css" /> 
		<link rel="stylesheet" href="css/text.css" /> 
		<link rel="stylesheet" href="css/960.css" /> 
		<link rel="stylesheet" href="css/estilo.css" /> 
		<link rel="stylesheet" href="css/lightbox.css" type="text/css" media="screen" />

		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>

		
		<script src="blockly/blockly_compressed.js"></script>
		<script src="blockly/blocks_compressed.js"></script>
		<script src="meusblocos.js"></script>
		<script src="teste.js"></script>
		<script src="fases/fase1.js"></script>
		<script src="fases/fase2.js"></script>
		<script src="blockly/msg/js/en.js"></script>
		<script src="blockly/javascript_compressed.js"></script>
	</head>

	<body onload="inicializar()">
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      	<script type="text/javascript" src="js/materialize.min.js"></script>


      	<nav class="blue darken-3" role="navigation">
	    	<div class="nav-wrapper container">
	    		<a id="logo-container" href="#" class="brand-logo">porEDU</a>

	      		<a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
	    	</div>
	  	</nav>

	  	<br>

      	<div id="alerta" class="modal">
      		<ul class="tabs">
		        <li class="tab col s3 cyan lighten-3"><a class="active" style="color:white;"href="#video">Vídeo</a></li>
		        <li class="tab col s3 teal accent-3"><a href="#obj" style="color:white;">Objetivo</a></li>
		        <li class="tab col s3 blue"><a href="#dicas" style="color:white;">Dicas</a></li>
	      	</ul>
	    	<div class="modal-content">
		      	<div id="video" class="col s12">

		      	</div>
			    <div id="obj">
			    	<h6 id="objh6"></h6>
			    	<canvas  id="telainicial" height="320" width="320" style="border:1px solid #d3d3d3;"></canvas>
			    	<canvas id="telaobjetivo" height="320" width="320" style="border:1px solid red;"></canvas>
			    </div>
			    <div id="dicas" class="col s12"><h6 id="dicash6"></h6></div>
	    	</div>
	  	</div>

	  	<div id="alertaAcerto" class="modal modal-fixed-footer">
		    <div class="modal-content">
	              <h1 class="flow-text center-align">PARABÉNS!</h1>
	              <h4 class="flow-text">Você conseguiu completar o objetivo.</h4>
		    	  <img width="30%" src="img/poranito.png" alt="" class="responsive-img">
	              <img width="30%" src="img/zygmundi.png" alt="" class="responsive-img">
		    </div>
		    <div class="modal-footer">
		    	<a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Próxima fase</a>
		    </div>
		</div>

		<div id="alertaErro" class="modal modal-fixed-footer">
		    <div class="modal-content">
	              <h1 class="flow-text center-align">FALTA POUCO!</h1>
	              <h3>Quase conseguiu atingir o objetivo</h3>
	              <br>
	               <img width="30%" src="img/poranito.png" alt="" class="responsive-img">
	              <p class="flow-text">Se não souber o objetivo, clique no botão <a class="waves-effect waves-light btn  light-blue darken-3" onclick="$('#alerta').openModal();">AJUDA</a></p>
		    </div>
		</div>

		<div class="container_12">
			<div class="grid_4">
				<canvas id="myCanvas" height="320" width="320" style="border:1px solid #d3d3d3;"></canvas>
				
				<div style="text-align:center;">
					<i onclick="pilha = [];"><a class="btn-large waves-effect waves-light red"><i class="material-icons">stop</i></a></i>
					<i onclick="runCode()"><a class="btn-floating btn-large waves-effect waves-light green"><i class="material-icons">play_arrow</i></a></i>
					<i onclick="reset()"><a class="btn-large waves-effect waves-light blue lighten-2"><i class="material-icons">replay</i></a></i>
				</div>

				<form action="#">
					<br>
				    <p class="range-field">
				      <input type="range" id="velocidadePoranito" value="1" min ="0.1" max="3.0" step ="0.1" />
				      <p style="position:absolute; float:left;">0.1s</p>
				      <p style="position:right; float:right;">3s</p>
				    </p>
				    <h6 class="center-align">Velocidade (segundos)</h6>
				 </form>

				 <a style="width:100%;" class="waves-effect waves-light btn  light-blue darken-3" onclick="$('#alerta').openModal();">AJUDA</a>
			</div>

			<div class="grid_8">
				<div id="blocklyDiv" style="height: 600px;"></div>
				    <xml id="toolbox" style="display: none">
				    	<script>iniciaToolBox();</script>
				    </xml>

				  	<script>
				  		var time = 0;
				    	var workspace = Blockly.inject('blocklyDiv',
					    {toolbox: document.getElementById('toolbox'),
					     zoom:
					         {controls: true,
					          wheel: true,
					          startScale: 0.9,
					          maxScale: 1.3,
					          minScale: 0.6,
					          scaleSpeed: 1.2},
					     trashcan: true});

				    	/*function showCode() {
				    		drawScreen();
					      // Generate JavaScript code and display it.
					      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
					      var code = Blockly.JavaScript.workspaceToCode(workspace);
					      alert(code);
					    }

					    function f(i, s){
					    	if(i != s.length ){
					    		setTimeout(function g(){
					    			eval(s[i]);
					    			f(i + 1, s);
					    		}, 1000);
					    	}
					    }*/

					    function runCode() {
					      pilha = [];
					   	  zerarMatriz(faseAtual);
					      // Generate JavaScript code and run it.
					      window.LoopTrap = 1000;
					      Blockly.JavaScript.INFINITE_LOOP_TRAP =
					          'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
					      var code = Blockly.JavaScript.workspaceToCode(workspace);

					      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
					      try {
					        eval(code);
					      } catch (e) {
					        alert(e);
					      } 
					      
					      rodarPilha();
					    }

					    function reset(){
					    	pilha = [];
					    	zerarMatriz(faseAtual);
					    }

					    function inicializar(){
					    	inicializaAjuda();
					    }
				    </script>
				</div>
			</div>
		</div>
	</body>
</html>